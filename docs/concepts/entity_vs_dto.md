# Entity vs DTO: ãªãœä½¿ã„åˆ†ã‘ã‚‹ã®ã‹ï¼Ÿ

## 1. ä¸€è¨€ã§ã„ã†ã¨

- **Entity (ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£)**: **ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¸­èº«ã€** ãã®ã‚‚ã®ã€‚
- **DTO (Data Transfer Object)**: **ã€Œç”»é¢ã‚„APIã¨ã®ã‚„ã‚Šå–ã‚Šã€** å°‚ç”¨ã®å®¹ã‚Œç‰©ã€‚

## 2. ãã‚Œãã‚Œã®å½¹å‰²

### ğŸ¢ Entity (ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£)
- **å½¹å‰²**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ 1å¯¾1 ã§å¯¾å¿œã™ã‚‹ã‚¯ãƒ©ã‚¹ã€‚
- **ç‰¹å¾´**: ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ï¼ˆä¿å­˜ï¼‰ãŒç›®çš„ã€‚
- **ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**: `@Entity`, `@Id`, `@Table` ãªã©ãŒä»˜ãã€‚
- **ä¾‹**: `User` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯ `password` ã‚«ãƒ©ãƒ ãŒã‚ã‚‹ãŸã‚ã€`User` Entityã«ã‚‚ `password` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹ã€‚

### ğŸ“¦ DTO (ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)
- **å½¹å‰²**: ãƒ‡ãƒ¼ã‚¿ã‚’é‹ã¶ãŸã‚ã ã‘ã®ç´”ç²‹ãªç®±ã€‚
- **ç‰¹å¾´**: ç”»é¢ã‚„APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¿…è¦ã¨ã™ã‚‹å½¢ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢ã™ã‚‹ã€‚
- **ç¨®é¡**:
    - **Request DTO**: å…¥åŠ›ç”¨ï¼ˆä¾‹: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ã®å†…å®¹ï¼‰
    - **Response DTO**: å‡ºåŠ›ç”¨ï¼ˆä¾‹: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤ºç”¨ï¼‰
- **ä¾‹**: `UserResponse` DTO ã«ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ `password` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å«ã‚ãªã„ã€‚

## 3. ãªãœåˆ†ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã‹ï¼Ÿï¼ˆãƒ¡ãƒªãƒƒãƒˆï¼‰

ã€Œå…¨éƒ¨ Entity ã§ã‚„ã‚Œã°æ¥½ã˜ã‚ƒãªã„ï¼Ÿã€ã¨æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€åˆ†ã‘ã‚‹ã“ã¨ã«ã¯**3ã¤ã®å¤§ããªç†ç”±**ãŒã‚ã‚Šã¾ã™ã€‚

### â‘  ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆæƒ…å ±ã‚’éš ã™ï¼‰
Entityã‚’ãã®ã¾ã¾è¿”ã™ã¨ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚„å†…éƒ¨ç®¡ç†ç”¨ã®ãƒ•ãƒ©ã‚°ãªã©ã€**è¦‹ã›ã¦ã¯ã„ã‘ãªã„æƒ…å ±ã¾ã§æµå‡º**ã—ã¦ã—ã¾ã„ã¾ã™ã€‚DTOã‚’ä½¿ã†ã“ã¨ã§ã€å…¬é–‹ã™ã‚‹æƒ…å ±ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã§ãã¾ã™ã€‚

### â‘¡ å¤‰æ›´ã¸ã®å¼·ã•ï¼ˆç–çµåˆï¼‰
ã‚‚ã—ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã€ã‚’å¤‰æ›´ã—ãŸããªã£ãŸã¨ã—ã¾ã™ã€‚
- **Entityã®ã¿ã®å ´åˆ**: DBã‚’å¤‰ãˆã‚‹ã¨ã€APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚‚å¤‰ã‚ã£ã¦ã—ã¾ã„ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆã‚¹ãƒãƒ›ã‚¢ãƒ—ãƒªãªã©ï¼‰ãŒå£Šã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
- **DTOã‚’ä½¿ã†å ´åˆ**: DB (Entity) ãŒå¤‰ã‚ã£ã¦ã‚‚ã€Serviceå±¤ã§ DTO ã¸ã®å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¿®æ­£ã™ã‚‹ã ã‘ã§ã€APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (DTO) ã¯å¤‰ãˆãšã«æ¸ˆã¿ã¾ã™ã€‚

### â‘¢ å¿…è¦ãªå½¢ã«æ•´å½¢ã§ãã‚‹
ç”»é¢è¡¨ç¤ºç”¨ã«ã€Œå§“ã€ã¨ã€Œåã€ã‚’çµåˆã—ã¦ã€Œæ°åã€ã¨ã—ã¦è¿”ã—ãŸã„å ´åˆãªã©ã€DBã®æ§‹é€ ã¨ã¯é•ã†å½¢ã§ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã—ãŸã„ã¨ãã« DTO ãŒå½¹ç«‹ã¡ã¾ã™ã€‚

## 4. ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œã¨å¤‰æ›

Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ãŒå¤‰æ›ã•ã‚ŒãªãŒã‚‰æµã‚Œã¦ã„ãã¾ã™ã€‚

```text
       (Request DTO)            (Request DTO)             (Entity)               (Entity)
Client ------------> Controller ------------> Service ------------> Repository ------------> DB
                                                 |
                                           [ å¤‰æ›å‡¦ç† ]
                                       (DTO <--> Entity)
                                                 |
Client <------------ Controller <------------ Service <------------ Repository <------------ DB
       (Response DTO)           (Response DTO)            (Entity)               (Entity)
```

### å…·ä½“çš„ãªå¤‰æ›ã®æµã‚Œ

1. **å…¥åŠ›æ™‚ (Create/Update)**
   - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ `BookRequest` (DTO) ãŒå±Šãã€‚
   - Serviceå±¤ã§ `BookRequest` â†’ `Book` (Entity) ã«å¤‰æ›ã™ã‚‹ã€‚
   - RepositoryãŒ `Book` (Entity) ã‚’DBã«ä¿å­˜ã™ã‚‹ã€‚

2. **å‡ºåŠ›æ™‚ (Get/Search)**
   - RepositoryãŒDBã‹ã‚‰ `Book` (Entity) ã‚’å–å¾—ã™ã‚‹ã€‚
   - Serviceå±¤ã§ `Book` (Entity) â†’ `BookResponse` (DTO) ã«å¤‰æ›ã™ã‚‹ã€‚
   - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã« `BookResponse` (DTO) ã‚’è¿”ã™ã€‚

## 5. ã‚³ãƒ¼ãƒ‰ã§ã®æ¯”è¼ƒ

### Entity (DBã®éƒ½åˆ)
```java
@Entity
public class User {
    @Id
    private Long id;
    private String username;
    private String password; // âš ï¸ å¤–ã«å‡ºã—ãŸããªã„ï¼
    private LocalDateTime createdAt;
    private boolean isDeleted; // âš ï¸ å†…éƒ¨ç®¡ç†ç”¨
}
```

### DTO (ç”»é¢ã®éƒ½åˆ)
```java
// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã™ç”¨
public class UserResponse {
    private Long id;
    private String username;
    // password ã¯å«ã¾ãªã„ï¼
    // isDeleted ã‚‚å«ã¾ãªã„ï¼
}
```

## ã¾ã¨ã‚

- **Entity** ã¯ **DB** ã®ãŸã‚ã®ã‚‚ã®ã€‚
- **DTO** ã¯ **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆç”»é¢ï¼‰** ã®ãŸã‚ã®ã‚‚ã®ã€‚
- ã“ã®2ã¤ã‚’ **Serviceå±¤** ã§å¤‰æ› (`toEntity`, `toResponse`) ã—ã¦ç¹‹ãã®ãŒã€å …ç‰¢ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆã®åŸºæœ¬ã§ã™ã€‚
